{"ast":null,"code":"// import firebase from 'firebase/app';\n// import * as firebase from \"firebase/app\"\nimport firebase from 'firebase/compat/app'; //v9\nimport 'firebase/compat/auth'; //v9\n// import \"firebase/auth\";\nimport firebaseConfig from \"../../firebaseBaseConfig\";\nimport jwt_decode from \"jwt-decode\";\nimport userImg from \"../../Assets/user.svg\";\nif (!firebase.apps.length) {\n  firebase.initializeApp(firebaseConfig);\n}\nconst setToken = () => {\n  firebase.auth().currentUser.getIdToken(true).then(function (idToken) {\n    localStorage.setItem('token', idToken);\n  });\n};\nexport const loginWithProvider = provider => {\n  return firebase.auth().signInWithPopup(provider).then(res => {\n    setToken();\n    return handleResponse(res);\n  }).catch(error => {\n    const message = {\n      error: error.message\n    };\n    return message;\n  });\n};\nexport const createAccount = (email, password) => {\n  return firebase.auth().createUserWithEmailAndPassword(email, password).then(res => {\n    setToken();\n    return handleResponse(res);\n  }).catch(error => {\n    const message = {\n      error: error.message\n    };\n    return message;\n  });\n};\nexport const loginWithEmail = (email, password) => {\n  return firebase.auth().signInWithEmailAndPassword(email, password).then(res => {\n    setToken();\n    return handleResponse(res);\n  }).catch(error => {\n    const message = {\n      error: error.message\n    };\n    return message;\n  });\n};\nconst defaultName = str => {\n  let myStr = str;\n  let firstWord = myStr.substring(0, 4);\n  return firstWord;\n};\nconst handleResponse = res => {\n  const {\n    displayName,\n    email,\n    photoURL\n  } = res.user;\n  const userInfo = {\n    isSignedIn: true,\n    name: displayName || defaultName(email),\n    email: email,\n    img: photoURL || userImg\n  };\n  return userInfo;\n};\nexport const getDecodedUser = () => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n    return {};\n  }\n  const {\n    name,\n    picture,\n    email\n  } = jwt_decode(token);\n  const decodedUser = {\n    isSignedIn: true,\n    name: name || defaultName(email),\n    email: email,\n    img: picture || userImg\n  };\n  return decodedUser;\n};\nexport const handleSignOut = () => {\n  return firebase.auth().signOut().then(() => {\n    localStorage.removeItem('token');\n    const signedOutUser = {\n      isSignedIn: false,\n      name: '',\n      email: '',\n      img: ''\n    };\n    return signedOutUser;\n  });\n};","map":{"version":3,"names":["firebase","firebaseConfig","jwt_decode","userImg","apps","length","initializeApp","setToken","auth","currentUser","getIdToken","then","idToken","localStorage","setItem","loginWithProvider","provider","signInWithPopup","res","handleResponse","catch","error","message","createAccount","email","password","createUserWithEmailAndPassword","loginWithEmail","signInWithEmailAndPassword","defaultName","str","myStr","firstWord","substring","displayName","photoURL","user","userInfo","isSignedIn","name","img","getDecodedUser","token","getItem","picture","decodedUser","handleSignOut","signOut","removeItem","signedOutUser"],"sources":["/Users/alexmoran/Documents/programming/Easy-Consulting-react/src/component/Login/LoginManager.jsx"],"sourcesContent":["// import firebase from 'firebase/app';\n// import * as firebase from \"firebase/app\"\nimport firebase from 'firebase/compat/app'; //v9\nimport 'firebase/compat/auth'; //v9\n// import \"firebase/auth\";\nimport firebaseConfig from \"../../firebaseBaseConfig\";\nimport jwt_decode from \"jwt-decode\";\nimport userImg from '../../Assets/user.svg';\n\nif(!firebase.apps.length){\n    firebase.initializeApp(firebaseConfig);\n}\n\nconst setToken = () => {\n  firebase.auth().currentUser.getIdToken(true)\n  .then(function(idToken) {\n    localStorage.setItem('token', idToken);\n  })\n}\n\nexport const loginWithProvider = (provider) => {\n    return firebase.auth().signInWithPopup(provider)\n    .then( res => {\n        setToken();\n        return handleResponse(res);\n    }).catch( error  => {\n        const message = {\n          error: error.message\n        }\n        return message;\n    });\n};\n\nexport const createAccount = (email, password) => {\n    return firebase.auth().createUserWithEmailAndPassword(email, password)\n    .then( res => {\n      setToken();\n      return handleResponse(res);\n    })\n    .catch( error  => {\n      const message = {\n        error: error.message\n      }\n      return message;\n    });\n}\n\nexport const loginWithEmail = (email, password) =>{\n  return firebase.auth().signInWithEmailAndPassword(email, password)\n  .then( res => {\n    setToken();\n    return handleResponse(res);\n  })\n  .catch( error => {\n      const message = {\n      error: error.message\n      }\n      return message;\n  });\n}\n\nconst defaultName = (str) => {\n  let myStr = str\n  let firstWord = myStr.substring(0, 4)\n  return firstWord;\n}\n\nconst handleResponse = (res) => {\n  const {displayName, email, photoURL} = res.user;\n  const userInfo = {\n    isSignedIn: true,\n    name: displayName || defaultName(email),\n    email: email,\n    img: photoURL || userImg,\n  }\n  return userInfo;\n}\n\nexport const getDecodedUser = () => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n      return {};\n  }\n  const { name, picture, email } = jwt_decode(token);\n  const decodedUser = {\n      isSignedIn: true,\n      name: name || defaultName(email),\n      email: email,\n      img: picture || userImg,\n  }\n  return decodedUser;\n}\n\nexport const handleSignOut = () => {\n  return firebase.auth().signOut()\n    .then(() => {\n        localStorage.removeItem('token');\n        const signedOutUser = {\n            isSignedIn: false,\n            name: '',\n            email: '',\n            img: ''\n        }\n        return signedOutUser;\n      })\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}