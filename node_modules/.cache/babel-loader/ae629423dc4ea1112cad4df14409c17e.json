{"ast":null,"code":"// import firebase from 'firebase/app';\n// import * as firebase from \"firebase/app\"\nimport firebase from'firebase/compat/app';//v9\nimport'firebase/compat/auth';//v9\n// import \"firebase/auth\";\nimport firebaseConfig from\"../../firebaseBaseConfig\";import jwt_decode from\"jwt-decode\";import userImg from\"../../Assets/user.svg\";if(!firebase.apps.length){firebase.initializeApp(firebaseConfig);}const setToken=()=>{firebase.auth().currentUser.getIdToken(true).then(function(idToken){localStorage.setItem('token',idToken);});};export const loginWithProvider=provider=>{return firebase.auth().signInWithPopup(provider).then(res=>{setToken();return handleResponse(res);}).catch(error=>{const message={error:error.message};return message;});};export const createAccount=(email,password)=>{return firebase.auth().createUserWithEmailAndPassword(email,password).then(res=>{setToken();return handleResponse(res);}).catch(error=>{const message={error:error.message};return message;});};export const loginWithEmail=(email,password)=>{return firebase.auth().signInWithEmailAndPassword(email,password).then(res=>{setToken();return handleResponse(res);}).catch(error=>{const message={error:error.message};return message;});};const defaultName=str=>{let myStr=str;let firstWord=myStr.substring(0,4);return firstWord;};const handleResponse=res=>{const{displayName,email,photoURL}=res.user;const userInfo={isSignedIn:true,name:displayName||defaultName(email),email:email,img:photoURL||userImg};return userInfo;};export const getDecodedUser=()=>{const token=localStorage.getItem('token');if(!token){return{};}const{name,picture,email}=jwt_decode(token);const decodedUser={isSignedIn:true,name:name||defaultName(email),email:email,img:picture||userImg};return decodedUser;};export const handleSignOut=()=>{return firebase.auth().signOut().then(()=>{localStorage.removeItem('token');const signedOutUser={isSignedIn:false,name:'',email:'',img:''};return signedOutUser;});};","map":{"version":3,"names":["firebase","firebaseConfig","jwt_decode","userImg","apps","length","initializeApp","setToken","auth","currentUser","getIdToken","then","idToken","localStorage","setItem","loginWithProvider","provider","signInWithPopup","res","handleResponse","catch","error","message","createAccount","email","password","createUserWithEmailAndPassword","loginWithEmail","signInWithEmailAndPassword","defaultName","str","myStr","firstWord","substring","displayName","photoURL","user","userInfo","isSignedIn","name","img","getDecodedUser","token","getItem","picture","decodedUser","handleSignOut","signOut","removeItem","signedOutUser"],"sources":["/Users/alexmoran/Documents/programming/abadiq_new_page/src/component/Login/LoginManager.jsx"],"sourcesContent":["// import firebase from 'firebase/app';\n// import * as firebase from \"firebase/app\"\nimport firebase from 'firebase/compat/app'; //v9\nimport 'firebase/compat/auth'; //v9\n// import \"firebase/auth\";\nimport firebaseConfig from \"../../firebaseBaseConfig\";\nimport jwt_decode from \"jwt-decode\";\nimport userImg from '../../Assets/user.svg';\n\nif(!firebase.apps.length){\n    firebase.initializeApp(firebaseConfig);\n}\n\nconst setToken = () => {\n  firebase.auth().currentUser.getIdToken(true)\n  .then(function(idToken) {\n    localStorage.setItem('token', idToken);\n  })\n}\n\nexport const loginWithProvider = (provider) => {\n    return firebase.auth().signInWithPopup(provider)\n    .then( res => {\n        setToken();\n        return handleResponse(res);\n    }).catch( error  => {\n        const message = {\n          error: error.message\n        }\n        return message;\n    });\n};\n\nexport const createAccount = (email, password) => {\n    return firebase.auth().createUserWithEmailAndPassword(email, password)\n    .then( res => {\n      setToken();\n      return handleResponse(res);\n    })\n    .catch( error  => {\n      const message = {\n        error: error.message\n      }\n      return message;\n    });\n}\n\nexport const loginWithEmail = (email, password) =>{\n  return firebase.auth().signInWithEmailAndPassword(email, password)\n  .then( res => {\n    setToken();\n    return handleResponse(res);\n  })\n  .catch( error => {\n      const message = {\n      error: error.message\n      }\n      return message;\n  });\n}\n\nconst defaultName = (str) => {\n  let myStr = str\n  let firstWord = myStr.substring(0, 4)\n  return firstWord;\n}\n\nconst handleResponse = (res) => {\n  const {displayName, email, photoURL} = res.user;\n  const userInfo = {\n    isSignedIn: true,\n    name: displayName || defaultName(email),\n    email: email,\n    img: photoURL || userImg,\n  }\n  return userInfo;\n}\n\nexport const getDecodedUser = () => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n      return {};\n  }\n  const { name, picture, email } = jwt_decode(token);\n  const decodedUser = {\n      isSignedIn: true,\n      name: name || defaultName(email),\n      email: email,\n      img: picture || userImg,\n  }\n  return decodedUser;\n}\n\nexport const handleSignOut = () => {\n  return firebase.auth().signOut()\n    .then(() => {\n        localStorage.removeItem('token');\n        const signedOutUser = {\n            isSignedIn: false,\n            name: '',\n            email: '',\n            img: ''\n        }\n        return signedOutUser;\n      })\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}